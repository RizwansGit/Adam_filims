<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adam Filims - Quotation Maker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #091f36 0%, #0f2862 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .form-section, .preview-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .form-section h2, .preview-section h2 {
            color: #0f2862;
            margin-bottom: 25px;
            font-size: 1.5rem;
            border-bottom: 2px solid #0f2862;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #091f36;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #0f2862;
        }

        .date-service-row {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #0f2862;
        }

        .service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .service-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .service-item label {
            margin-bottom: 0;
            flex: 1;
        }

        .service-item input {
            width: 80px;
            margin-bottom: 0;
        }

        .btn {
            background: #0f2862;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
            margin: 5px;
        }

        .btn:hover {
            background: #091f36;
        }

        .btn-secondary {
            background: #4f5f76;
        }

        .btn-secondary:hover {
            background: #3a4456;
        }

        .btn-danger {
            background: #9e363a;
        }

        .btn-danger:hover {
            background: #7a2b2e;
        }

        .btn-success {
            background: #28a745;
        }

        .btn-success:hover {
            background: #218838;
        }

        .pricing-section {
            background: #f0f4f8;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .pricing-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .quotation-preview {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            font-size: 14px;
            line-height: 1.6;
            page-break-inside: avoid;
        }

        .quotation-header {
            text-align: center;
            border-bottom: 2px solid #0f2862;
            padding-bottom: 20px;
            margin-bottom: 25px;
            page-break-after: avoid;
        }

        .quotation-header h1 {
            color: #0f2862;
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .quotation-content {
            margin-bottom: 25px;
        }

        .service-breakdown {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            page-break-inside: avoid;
        }

        .total-section {
            background: #0f2862;
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
            page-break-inside: avoid;
        }

        .payment-schedule {
            background: #f0f4f8;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            page-break-inside: avoid;
        }

        .terms {
            font-size: 12px;
            color: #666;
            border-top: 1px solid #ddd;
            padding-top: 15px;
            margin-top: 20px;
            page-break-inside: avoid;
        }

        .export-buttons {
            text-align: center;
            margin-top: 20px;
            gap: 10px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }

        .done-section {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: #e8f5e8;
            border-radius: 10px;
            border: 2px solid #28a745;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .form-section, .preview-section {
                padding: 20px;
            }
        }

        .admin-section {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .hidden {
            display: none;
        }

        .calculation-debug {
            background: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ADAM FILIMS</h1>
            <p>Professional Wedding Photography & Videography</p>
            <p>☎ +91 8147956159 | 📷 @adam_filims</p>
        </div>

        <!-- Admin Panel Toggle -->
        <div style="text-align: center; margin-bottom: 20px;">
            <button class="btn btn-secondary" onclick="toggleAdmin()">⚙ Admin Settings</button>
        </div>

        <!-- Admin Panel -->
        <div id="adminPanel" class="admin-section hidden">
            <h3>Admin Settings</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                <div class="form-group">
                    <label>Photographer Rate (per day):</label>
                    <input type="number" id="photographerRate" value="5000" onchange="saveSettings()">
                </div>
                <div class="form-group">
                    <label>Videographer Rate (per day):</label>
                    <input type="number" id="videographerRate" value="7000" onchange="saveSettings()">
                </div>
                <div class="form-group">
                    <label>Drone Rate (per event):</label>
                    <input type="number" id="droneRate" value="15000" onchange="saveSettings()">
                </div>
                <div class="form-group">
                    <label>Business Address:</label>
                    <input type="text" id="businessAddress" value="Bangalore, Karnataka" onchange="saveSettings()">
                </div>
            </div>
        </div>

        <div class="main-content">
            <!-- Form Section -->
            <div class="form-section">
                <h2>📋 Quotation Details</h2>
                
                <div class="form-group">
                    <label>Client Name:</label>
                    <input type="text" id="clientName" placeholder="Enter client name" oninput="updatePreview()">
                </div>

                <div class="form-group">
                    <label>Contact Number:</label>
                    <input type="tel" id="contactNumber" placeholder="Enter contact number" oninput="updatePreview()">
                </div>

                <div class="form-group">
                    <label>Venue Name:</label>
                    <input type="text" id="venueName" placeholder="Enter venue name" oninput="updatePreview()">
                </div>

                <div class="form-group">
                    <label>Additional Notes:</label>
                    <textarea id="additionalNotes" rows="3" placeholder="Any special requirements or notes" oninput="updatePreview()"></textarea>
                </div>

                <!-- Event Dates and Services -->
                <div id="eventDates">
                    <h3 style="color: #0f2862; margin: 20px 0 15px 0;">📅 Event Dates & Services</h3>
                </div>

                <button class="btn" onclick="addDateService()">✚ Add Event Date</button>

                <!-- Pricing Section -->
                <div class="pricing-section">
                    <h3 style="color: #0f2862; margin-bottom: 15px;">💰 Pricing</h3>
                    
                    <div class="pricing-toggle">
                        <button class="btn" id="autoBtn" onclick="setPricingMode('auto')">Auto Calculate</button>
                        <button class="btn btn-secondary" id="fixedBtn" onclick="setPricingMode('fixed')">Fixed Package</button>
                    </div>

                    <div id="fixedPricing" class="hidden">
                        <div class="form-group">
                            <label>Package Amount (₹):</label>
                            <input type="number" id="fixedAmount" placeholder="Enter package amount" oninput="updatePreview()">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Booking Advance (₹):</label>
                        <input type="number" id="bookingAdvance" placeholder="Enter advance amount" oninput="updatePreview()">
                    </div>

                    <div class="form-group">
                        <label>Pre-Wedding Payment (₹):</label>
                        <input type="number" id="preWeddingPayment" placeholder="Enter pre-wedding payment" oninput="updatePreview()">
                    </div>

                    <div class="form-group">
                        <label>Wedding Day Payment (₹):</label>
                        <input type="number" id="weddingDayPayment" placeholder="Enter wedding day payment" oninput="updatePreview()">
                    </div>

                    <div class="form-group">
                        <label>Final Payment (₹):</label>
                        <input type="number" id="finalPayment" placeholder="Enter final payment" oninput="updatePreview()">
                    </div>
                </div>

                <!-- Done Button -->
                <div class="done-section">
                    <button class="btn btn-success" onclick="markDone()" style="font-size: 18px; padding: 15px 30px;">
                        ✓ Done - Finalize Quotation
                    </button>
                    <p style="margin-top: 10px; font-size: 14px; color: #666;">
                        Click when all details are entered to calculate final amounts
                    </p>
                </div>
            </div>

            <!-- Preview Section -->
            <div class="preview-section">
                <h2>Quotation Preview</h2>
                
                <div id="quotationPreview" class="quotation-preview">
                    <!-- Preview content will be generated here -->
                </div>

                <div class="export-buttons">
                    <button class="btn" onclick="exportPDF()">📄 Download PDF</button>
                    <button class="btn btn-secondary" onclick="exportImage()">🖼 Save as Image</button>
                    <button class="btn btn-secondary" onclick="printQuotation()">🖨 Print</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Include jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script>
        let eventDatesCount = 0;
        let pricingMode = 'auto';
        let isFinalized = false;

        // Initialize with one date
        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            addDateService();
            updatePreview();
        });

        function loadSettings() {
            // Don't use localStorage in Claude.ai environment
            // Use default values
            document.getElementById('photographerRate').value = '5000';
            document.getElementById('videographerRate').value = '7000';
            document.getElementById('droneRate').value = '15000';
            document.getElementById('businessAddress').value = 'Mangaluru, Karnataka';
        }

        function saveSettings() {
            // Settings are saved in memory only
            updatePreview();
        }

        function toggleAdmin() {
            const panel = document.getElementById('adminPanel');
            panel.classList.toggle('hidden');
        }

        function addDateService() {
            eventDatesCount++;
            const eventDatesDiv = document.getElementById('eventDates');
            
            const dateServiceHTML = `
                <div class="date-service-row" id="dateService${eventDatesCount}">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h4 style="color: #0f2862;">Event Day ${eventDatesCount}</h4>
                        ${eventDatesCount > 1 ? `<button class="btn btn-danger" onclick="removeDateService(${eventDatesCount})" style="margin-left: auto; padding: 5px 10px; font-size: 12px;">✕ Remove</button>` : ''}
                    </div>
                    
                    <div class="form-group">
                        <label>Event Date:</label>
                        <input type="date" id="eventDate${eventDatesCount}" oninput="updatePreview()">
                    </div>

                    <div class="service-grid">
                        <div class="service-item">
                            <label>Candid Photographers:</label>
                            <input type="number" id="candidPhotographers${eventDatesCount}" min="0" max="5" value="0" oninput="updatePreview()">
                        </div>
                        <div class="service-item">
                            <label>Traditional Photographers:</label>
                            <input type="number" id="traditionalPhotographers${eventDatesCount}" min="0" max="5" value="0" oninput="updatePreview()">
                        </div>
                        <div class="service-item">
                            <label>Candid Videographers:</label>
                            <input type="number" id="candidVideographers${eventDatesCount}" min="0" max="5" value="0" oninput="updatePreview()">
                        </div>
                        <div class="service-item">
                            <label>Traditional Videographers:</label>
                            <input type="number" id="traditionalVideographers${eventDatesCount}" min="0" max="5" value="0" oninput="updatePreview()">
                        </div>
                        <div class="service-item">
                            <label>Drone Service:</label>
                            <select id="droneService${eventDatesCount}" onchange="updatePreview()">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                            </select>
                        </div>
                    </div>
                </div>
            `;
            
            eventDatesDiv.insertAdjacentHTML('beforeend', dateServiceHTML);
            updatePreview();
        }

        function removeDateService(id) {
            document.getElementById(`dateService${id}`).remove();
            updatePreview();
        }

        function setPricingMode(mode) {
            pricingMode = mode;
            const autoBtn = document.getElementById('autoBtn');
            const fixedBtn = document.getElementById('fixedBtn');
            const fixedPricing = document.getElementById('fixedPricing');

            if (mode === 'auto') {
                autoBtn.className = 'btn';
                fixedBtn.className = 'btn btn-secondary';
                fixedPricing.classList.add('hidden');
            } else {
                autoBtn.className = 'btn btn-secondary';
                fixedBtn.className = 'btn';
                fixedPricing.classList.remove('hidden');
            }
            updatePreview();
        }

        function markDone() {
            isFinalized = true;
            updatePreview();
            
            // Show success message
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '✅ Quotation Finalized!';
            btn.style.background = '#218838';
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.style.background = '#28a745';
            }, 2000);
        }

        function calculateTotal() {
            if (pricingMode === 'fixed') {
                const fixedAmount = parseInt(document.getElementById('fixedAmount').value) || 0;
                console.log('Fixed pricing mode, amount:', fixedAmount);
                return fixedAmount;
            }

            let total = 0;
            const photographerRate = parseInt(document.getElementById('photographerRate').value) || 5000;
            const videographerRate = parseInt(document.getElementById('videographerRate').value) || 7000;
            const droneRate = parseInt(document.getElementById('droneRate').value) || 15000;

            console.log('Auto calculation mode');
            console.log('Rates - Photographer:', photographerRate, 'Videographer:', videographerRate, 'Drone:', droneRate);

            // Calculate for each event date
            for (let i = 1; i <= eventDatesCount; i++) {
                const dateElement = document.getElementById(`eventDate${i}`);
                if (!dateElement) continue;

                const candidPhotographers = parseInt(document.getElementById(`candidPhotographers${i}`)?.value) || 0;
                const traditionalPhotographers = parseInt(document.getElementById(`traditionalPhotographers${i}`)?.value) || 0;
                const candidVideographers = parseInt(document.getElementById(`candidVideographers${i}`)?.value) || 0;
                const traditionalVideographers = parseInt(document.getElementById(`traditionalVideographers${i}`)?.value) || 0;
                const droneService = document.getElementById(`droneService${i}`)?.value === 'yes';

                const dayTotal = 
                    (candidPhotographers + traditionalPhotographers) * photographerRate +
                    (candidVideographers + traditionalVideographers) * videographerRate +
                    (droneService ? droneRate : 0);

                console.log(`Day ${i}:`, {
                    candidPhotographers,
                    traditionalPhotographers,
                    candidVideographers,
                    traditionalVideographers,
                    droneService,
                    dayTotal
                });

                total += dayTotal;
            }

            console.log('Final total:', total);
            return total;
        }

        function updatePreview() {
            const clientName = document.getElementById('clientName').value || '[Client Name]';
            const contactNumber = document.getElementById('contactNumber').value || '[Contact Number]';
            const venueName = document.getElementById('venueName').value || '[Venue Name]';
            const additionalNotes = document.getElementById('additionalNotes').value || '';
            const businessAddress = document.getElementById('businessAddress').value || 'Mangaluru, Karnataka';

            const bookingAdvance = parseInt(document.getElementById('bookingAdvance').value) || 0;
            const preWeddingPayment = parseInt(document.getElementById('preWeddingPayment').value) || 0;
            const weddingDayPayment = parseInt(document.getElementById('weddingDayPayment').value) || 0;
            const finalPayment = parseInt(document.getElementById('finalPayment').value) || 0;

            const total = calculateTotal();

            let servicesHTML = '';
            for (let i = 1; i <= eventDatesCount; i++) {
                const dateElement = document.getElementById(`eventDate${i}`);
                if (!dateElement) continue;

                const eventDate = dateElement.value || '[Event Date]';
                const candidPhotographers = parseInt(document.getElementById(`candidPhotographers${i}`)?.value) || 0;
                const traditionalPhotographers = parseInt(document.getElementById(`traditionalPhotographers${i}`)?.value) || 0;
                const candidVideographers = parseInt(document.getElementById(`candidVideographers${i}`)?.value) || 0;
                const traditionalVideographers = parseInt(document.getElementById(`traditionalVideographers${i}`)?.value) || 0;
                const droneService = document.getElementById(`droneService${i}`)?.value === 'yes';

                if (candidPhotographers > 0 || traditionalPhotographers > 0 || candidVideographers > 0 || traditionalVideographers > 0 || droneService) {
                    servicesHTML += `
                        <div class="service-breakdown">
                            <h4>📅 ${new Date(eventDate).toLocaleDateString('en-GB') || eventDate}</h4>
                            ${candidPhotographers > 0 ? `<p>📸 Candid Photographers: ${candidPhotographers}</p>` : ''}
                            ${traditionalPhotographers > 0 ? `<p>📷 Traditional Photographers: ${traditionalPhotographers}</p>` : ''}
                            ${candidVideographers > 0 ? `<p>🎥 Candid Videographers: ${candidVideographers}</p>` : ''}
                            ${traditionalVideographers > 0 ? `<p>🎬 Traditional Videographers: ${traditionalVideographers}</p>` : ''}
                            ${droneService ? `<p>🚁 Drone Service: Yes</p>` : ''}
                        </div>
                    `;
                }
            }

            const quotationHTML = `
                <div class="quotation-header">
                    <h1>ADAM FILIMS</h1>
                    <p><strong>Professional Wedding Photography & Videography</strong></p>
                    <p>☎ +91 8147956159</p>
                    <p>📍 ${businessAddress}</p>
                    <p>📷 Instagram: @adam_filims</p>
                </div>

                <div class="quotation-content">
                    <h3 style="color: #0f2862; margin-bottom: 15px;">SERVICE CONTRACT AGREEMENT</h3>
                    
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #0f2862;">Parties</h4>
                        <p>The service contract agreement is entered into on <strong>${new Date().toLocaleDateString('en-GB')}</strong> by <strong>Adam Filims</strong> with an address of <strong>${businessAddress}</strong> and with <strong>${clientName}</strong> with an address of <strong>${venueName}</strong>.</p>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #0f2862;">Consideration</h4>
                        <p>The parties agree that the wedding company Adam Filims will provide the photography services attached hereunder whereas the client will in return provide compensation for service and expertise.</p>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #0f2862;">Service</h4>
                        <p>The consultant's services are summarised as follows:</p>
                        ${servicesHTML || '<p>No services selected yet</p>'}
                    </div>

                    <div class="total-section">
                        <h3>TOTAL PACKAGE AMOUNT</h3>
                        <h2>₹${total.toLocaleString('en-IN')}</h2>
                        ${isFinalized ? '<p style="margin-top: 10px;">✅ Finalized</p>' : ''}
                    </div>

                    ${(bookingAdvance > 0 || preWeddingPayment > 0 || weddingDayPayment > 0 || finalPayment > 0) ? `
                        <div class="payment-schedule">
                            <h4 style="color: #0f2862;">Payment Schedule:</h4>
                            ${bookingAdvance > 0 ? `<p>💰 Booking Advance: ₹${bookingAdvance.toLocaleString('en-IN')}</p>` : ''}
                            ${preWeddingPayment > 0 ? `<p>💰 Pre-Wedding Payment: ₹${preWeddingPayment.toLocaleString('en-IN')}</p>` : ''}
                            ${weddingDayPayment > 0 ? `<p>💰 Wedding Day Payment: ₹${weddingDayPayment.toLocaleString('en-IN')}</p>` : ''}
                            ${finalPayment > 0 ? `<p>💰 Final Payment: ₹${finalPayment.toLocaleString('en-IN')}</p>` : ''}
                        </div>
                    ` : ''}

                    <p style="margin: 20px 0;"><strong>All the output will be delivered within 30 days from after selecting photos.</strong></p>
                    
                    <p style="margin: 20px 0;">Thank you for doing business with us. If there is any issue or you require clarification please let me know.</p>
                    
                    <p style="margin: 20px 0;"><strong>Contact us:</strong> +91 8147956159 (Shadeed)</p>
                    
                    <p style="margin: 20px 0; text-align: center;"><strong>E. & O.E.</strong></p>

                    <div class="terms">
                        <h4 style="color: #0f2862;">TERMS AND CONDITIONS</h4>
                        <p><strong>• Accommodation Extra</strong></p>
                        <p>• In Case of extra print @ INR 600 will be charged per leaf both side (per leaf 12 photos)</p>
                        <p>• 10% of package amount needs to pay as advance</p>
                        <p>• 80% needs to pay on the event date</p>
                        <p>• Balance Amount 10% needs to pay on the date of full work delivery</p>
                        <p>• All the output will be given within 30 days after selecting album</p>
                        <p>• Client is responsible for vendor meals during event</p>
                        <p>• Weather conditions may affect outdoor shoots</p>
                        <p>• Travel charges may apply for destinations beyond 50km</p>
                    </div>
                </div>
            `;

            document.getElementById('quotationPreview').innerHTML = quotationHTML;
        }

        function exportPDF() {
            const { jsPDF } = window.jspdf;
            const clientName = document.getElementById('clientName').value || 'Client';
            
            // Create PDF in A4 portrait format
            const pdf = new jsPDF({
                orientation: 'portrait',
                unit: 'mm',
                format: 'a4'
            });

            const pageWidth = pdf.internal.pageSize.getWidth();
            const pageHeight = pdf.internal.pageSize.getHeight();
            const margin = 15;
            let currentY = margin;

            // Set font
            pdf.setFont('helvetica');

            // Helper function to add text with automatic line breaks
            function addText(text, x, y, maxWidth, fontSize = 10, color = [0, 0, 0], isBold = false) {
                pdf.setFontSize(fontSize);
                pdf.setTextColor(color[0], color[1], color[2]);
                if (isBold) {
                    pdf.setFont('helvetica', 'bold');
                } else {
                    pdf.setFont('helvetica', 'normal');
                }
                
                const lines = pdf.splitTextToSize(text, maxWidth);
                pdf.text(lines, x, y);
                return y + (lines.length * (fontSize * 0.4));
            }

            function checkPageBreak(neededSpace = 20) {
                if (currentY + neededSpace > pageHeight - margin) {
                    pdf.addPage();
                    currentY = margin;
                }
            }

            // Header
            currentY = addText('ADAM FILIMS', pageWidth / 2, currentY, pageWidth - 2 * margin, 20, [15, 40, 98], true);
            pdf.setFont('helvetica', 'normal');
            pdf.text('ADAM FILIMS', pageWidth / 2, currentY - 8, { align: 'center' });
            
            currentY += 5;
            currentY = addText('Professional Wedding Photography & Videography', pageWidth / 2, currentY, pageWidth - 2 * margin, 12);
            pdf.text('Professional Wedding Photography & Videography', pageWidth / 2, currentY - 4, { align: 'center' });
            
            currentY += 3;
            const businessAddress = document.getElementById('businessAddress').value || 'Mangaluru, Karnataka';
            currentY = addText(`☎ +91 8147956159 | 📍 ${businessAddress}`, pageWidth / 2, currentY, pageWidth - 2 * margin, 10);
            pdf.text(`☎ +91 8147956159 | 📍 ${businessAddress}`, pageWidth / 2, currentY - 3, { align: 'center' });
            
            currentY += 3;
            currentY = addText('📷 Instagram: @adam_filims', pageWidth / 2, currentY, pageWidth - 2 * margin, 10);
            pdf.text('📷 Instagram: @adam_filims', pageWidth / 2, currentY - 3, { align: 'center' });
            
            currentY += 10;

            // Draw separator line
            pdf.setDrawColor(15, 40, 98);
            pdf.setLineWidth(0.5);
            pdf.line(margin, currentY, pageWidth - margin, currentY);
            currentY += 10;

            // Contract Agreement Title
            currentY = addText('SERVICE CONTRACT AGREEMENT', pageWidth / 2, currentY, pageWidth - 2 * margin, 16, [15, 40, 98], true);
            pdf.text('SERVICE CONTRACT AGREEMENT', pageWidth / 2, currentY - 6, { align: 'center' });
            currentY += 10;

            // Parties Section
            checkPageBreak(30);
            currentY = addText('Parties', margin, currentY, pageWidth - 2 * margin, 12, [15, 40, 98], true);
            currentY += 3;
            
            const clientName_val = document.getElementById('clientName').value || '[Client Name]';
            const venueName = document.getElementById('venueName').value || '[Venue Name]';
            const partiesText = `The service contract agreement is entered into on ${new Date().toLocaleDateString('en-GB')} by Adam Filims with an address of ${businessAddress} and with ${clientName_val} with an address of ${venueName}.`;
            currentY = addText(partiesText, margin, currentY, pageWidth - 2 * margin, 10);
            currentY += 8;

            // Consideration Section
            checkPageBreak(25);
            currentY = addText('Consideration', margin, currentY, pageWidth - 2 * margin, 12, [15, 40, 98], true);
            currentY += 3;
            
            const considerationText = 'The parties agree that the wedding company Adam Filims will provide the photography services attached hereunder whereas the client will in return provide compensation for service and expertise.';
            currentY = addText(considerationText, margin, currentY, pageWidth - 2 * margin, 10);
            currentY += 8;

            // Service Section
            checkPageBreak(30);
            currentY = addText('Service', margin, currentY, pageWidth - 2 * margin, 12, [15, 40, 98], true);
            currentY += 3;
            
            currentY = addText('The consultant\'s services are summarised as follows:', margin, currentY, pageWidth - 2 * margin, 10);
            currentY += 8;

            // Service breakdown
            for (let i = 1; i <= eventDatesCount; i++) {
                const dateElement = document.getElementById(`eventDate${i}`);
                if (!dateElement) continue;

                const eventDate = dateElement.value || '[Event Date]';
                const candidPhotographers = parseInt(document.getElementById(`candidPhotographers${i}`)?.value) || 0;
                const traditionalPhotographers = parseInt(document.getElementById(`traditionalPhotographers${i}`)?.value) || 0;
                const candidVideographers = parseInt(document.getElementById(`candidVideographers${i}`)?.value) || 0;
                const traditionalVideographers = parseInt(document.getElementById(`traditionalVideographers${i}`)?.value) || 0;
                const droneService = document.getElementById(`droneService${i}`)?.value === 'yes';

                if (candidPhotographers > 0 || traditionalPhotographers > 0 || candidVideographers > 0 || traditionalVideographers > 0 || droneService) {
                    checkPageBreak(25);
                    
                    const formattedDate = eventDate ? new Date(eventDate).toLocaleDateString('en-GB') : '[Event Date]';
                    currentY = addText(`📅 ${formattedDate}`, margin + 5, currentY, pageWidth - 2 * margin, 11, [15, 40, 98], true);
                    currentY += 2;
                    
                    if (candidPhotographers > 0) {
                        currentY = addText(`📸 Candid Photographers: ${candidPhotographers}`, margin + 10, currentY, pageWidth - 2 * margin, 10);
                    }
                    if (traditionalPhotographers > 0) {
                        currentY = addText(`📷 Traditional Photographers: ${traditionalPhotographers}`, margin + 10, currentY, pageWidth - 2 * margin, 10);
                    }
                    if (candidVideographers > 0) {
                        currentY = addText(`🎥 Candid Videographers: ${candidVideographers}`, margin + 10, currentY, pageWidth - 2 * margin, 10);
                    }
                    if (traditionalVideographers > 0) {
                        currentY = addText(`🎬 Traditional Videographers: ${traditionalVideographers}`, margin + 10, currentY, pageWidth - 2 * margin, 10);
                    }
                    if (droneService) {
                        currentY = addText('🚁 Drone Service: Yes', margin + 10, currentY, pageWidth - 2 * margin, 10);
                    }
                    currentY += 5;
                }
            }

            // Total Package Amount
            checkPageBreak(25);
            const total = calculateTotal();
            
            // Draw background rectangle for total
            pdf.setFillColor(15, 40, 98);
            pdf.rect(margin, currentY - 3, pageWidth - 2 * margin, 20, 'F');
            
            currentY = addText('TOTAL PACKAGE AMOUNT', pageWidth / 2, currentY + 3, pageWidth - 2 * margin, 14, [255, 255, 255], true);
            pdf.text('TOTAL PACKAGE AMOUNT', pageWidth / 2, currentY - 5, { align: 'center' });
            
            currentY = addText(`₹${total.toLocaleString('en-IN')}`, pageWidth / 2, currentY + 2, pageWidth - 2 * margin, 16, [255, 255, 255], true);
            pdf.text(`₹${total.toLocaleString('en-IN')}`, pageWidth / 2, currentY - 6, { align: 'center' });
            
            currentY += 10;

            // Payment Schedule
            const bookingAdvance = parseInt(document.getElementById('bookingAdvance').value) || 0;
            const preWeddingPayment = parseInt(document.getElementById('preWeddingPayment').value) || 0;
            const weddingDayPayment = parseInt(document.getElementById('weddingDayPayment').value) || 0;
            const finalPayment = parseInt(document.getElementById('finalPayment').value) || 0;

            if (bookingAdvance > 0 || preWeddingPayment > 0 || weddingDayPayment > 0 || finalPayment > 0) {
                checkPageBreak(30);
                currentY = addText('Payment Schedule:', margin, currentY, pageWidth - 2 * margin, 12, [15, 40, 98], true);
                currentY += 3;
                
                if (bookingAdvance > 0) {
                    currentY = addText(`💰 Booking Advance: ₹${bookingAdvance.toLocaleString('en-IN')}`, margin + 5, currentY, pageWidth - 2 * margin, 10);
                }
                if (preWeddingPayment > 0) {
                    currentY = addText(`💰 Pre-Wedding Payment: ₹${preWeddingPayment.toLocaleString('en-IN')}`, margin + 5, currentY, pageWidth - 2 * margin, 10);
                }
                if (weddingDayPayment > 0) {
                    currentY = addText(`💰 Wedding Day Payment: ₹${weddingDayPayment.toLocaleString('en-IN')}`, margin + 5, currentY, pageWidth - 2 * margin, 10);
                }
                if (finalPayment > 0) {
                    currentY = addText(`💰 Final Payment: ₹${finalPayment.toLocaleString('en-IN')}`, margin + 5, currentY, pageWidth - 2 * margin, 10);
                }
                currentY += 8;
            }

            // Delivery and contact info
            checkPageBreak(20);
            currentY = addText('All the output will be delivered within 30 days from after selecting photos.', margin, currentY, pageWidth - 2 * margin, 10, [0, 0, 0], true);
            currentY += 5;
            
            currentY = addText('Thank you for doing business with us. If there is any issue or you require clarification please let me know.', margin, currentY, pageWidth - 2 * margin, 10);
            currentY += 5;
            
            currentY = addText('Contact us: +91 8147956159 (Shadeed)', margin, currentY, pageWidth - 2 * margin, 10, [0, 0, 0], true);
            currentY += 8;
            
            currentY = addText('E. & O.E.', pageWidth / 2, currentY, pageWidth - 2 * margin, 10);
            pdf.text('E. & O.E.', pageWidth / 2, currentY - 3, { align: 'center' });
            currentY += 10;

            // Terms & Conditions
            checkPageBreak(50);
            currentY = addText('TERMS AND CONDITIONS', margin, currentY, pageWidth - 2 * margin, 12, [15, 40, 98], true);
            currentY += 5;
            
            const terms = [
                '• Accommodation Extra',
                '• In Case of extra print @ INR 600 will be charged per leaf both side (per leaf 12 photos)',
                '• 10% of package amount needs to pay as advance',
                '• 80% needs to pay on the event date',
                '• Balance Amount 10% needs to pay on the date of full work delivery',
                '• All the output will be given within 30 days after selecting album',
                '• Client is responsible for vendor meals during event',
                '• Weather conditions may affect outdoor shoots',
                '• Travel charges may apply for destinations beyond 50km'
            ];

            terms.forEach(term => {
                checkPageBreak(8);
                currentY = addText(term, margin, currentY, pageWidth - 2 * margin, 9);
                currentY += 1;
            });

            // Save the PDF
            pdf.save(`${clientName}_Wedding_Contract_${new Date().toISOString().split('T')[0]}.pdf`);
        }

        function exportImage() {
            const element = document.getElementById('quotationPreview');
            
            html2canvas(element, {
                scale: 2,
                useCORS: true,
                letterRendering: 1,
                allowTaint: false,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                const link = document.createElement('a');
                const clientName = document.getElementById('clientName').value || 'Client';
                link.download = `${clientName}_Wedding_Quotation_${new Date().toISOString().split('T')[0]}.png`;
                link.href = canvas.toDataURL('image/png', 1.0);
                link.click();
            });
        }

        function printQuotation() {
            const printWindow = window.open('', '_blank');
            const quotationContent = document.getElementById('quotationPreview').innerHTML;
            
            printWindow.document.write(`
                <html>
                    <head>
                        <title>Adam Filims - Wedding Quotation</title>
                        <style>
                            @media print {
                                body { 
                                    font-family: Arial, sans-serif; 
                                    margin: 0; 
                                    padding: 20px;
                                    font-size: 12px;
                                }
                                .quotation-preview { 
                                    background: white !important; 
                                    box-shadow: none !important;
                                    padding: 0 !important;
                                }
                                .quotation-header { 
                                    text-align: center; 
                                    border-bottom: 2px solid #0f2862; 
                                    padding-bottom: 20px; 
                                    margin-bottom: 25px; 
                                }
                                .quotation-header h1 { 
                                    color: #0f2862 !important; 
                                    font-size: 24px !important; 
                                    margin-bottom: 10px; 
                                }
                                .service-breakdown { 
                                    background: #f8f9fa !important; 
                                    padding: 15px; 
                                    border-radius: 8px; 
                                    margin: 15px 0; 
                                    -webkit-print-color-adjust: exact;
                                }
                                .total-section { 
                                    background: #0f2862 !important; 
                                    color: white !important; 
                                    padding: 20px; 
                                    border-radius: 10px; 
                                    text-align: center; 
                                    margin: 20px 0; 
                                    -webkit-print-color-adjust: exact;
                                }
                                .payment-schedule { 
                                    background: #f0f4f8 !important; 
                                    padding: 15px; 
                                    border-radius: 8px; 
                                    margin: 15px 0; 
                                    -webkit-print-color-adjust: exact;
                                }
                                .terms { 
                                    font-size: 11px; 
                                    color: #666; 
                                    border-top: 1px solid #ddd; 
                                    padding-top: 15px; 
                                    margin-top: 20px; 
                                }
                            }
                        </style>
                    </head>
                    <body>
                        <div class="quotation-preview">${quotationContent}</div>
                        <script>
                            window.onload = function() {
                                window.print();
                                window.onafterprint = function() {
                                    window.close();
                                }
                            }
                        </script>
                    </body>
                </html>
            `);
            
            printWindow.document.close();
        }
    </script>
</body>
</html>
